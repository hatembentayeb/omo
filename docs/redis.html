<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Redis Plugin — omo</title>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>

<!-- Header -->
<header class="header">
  <div class="header-inner">
    <a href="index.html" class="header-brand">
      <span class="header-title">omo</span>
    </a>
    <div class="header-links">
      <a href="https://github.com/hatembentayeb/omo" class="github-link" target="_blank" rel="noopener">GitHub</a>
    </div>
  </div>
</header>

<!-- Sidebar -->
<nav class="sidebar" id="sidebar">
  <a href="index.html" class="back-link">Back to Manual</a>
  <div class="sidebar-heading">Redis Plugin</div>
  <a href="#overview">Overview</a>
  <a href="#prerequisites">Prerequisites</a>
  <a href="#configuration">Configuration</a>
  <a href="#keepass-secrets">KeePass Secrets</a>
  <a href="#keybindings">Keybindings</a>
  <a href="#views">Views</a>
  <a href="#troubleshooting">Troubleshooting</a>
</nav>

<!-- Main -->
<main class="main">
  <div class="content">

    <section class="section plugin-hero" id="overview">
      <h1>Redis Plugin</h1>
      <p class="lead">Manage Redis instances and monitor performance. Key browser, TTL management, live metrics, slowlog, pub/sub, replication monitoring.</p>
      <div class="plugin-tags">
        <span class="tag">database</span>
        <span class="tag">cache</span>
        <span class="tag">monitoring</span>
      </div>
    </section>

    <hr class="section-divider">

    <section class="section" id="prerequisites">
      <h2>Prerequisites</h2>
      <ul>
        <li>A running Redis server (local or remote)</li>
        <li>Redis 6+ recommended for ACL username support</li>
        <li>Network access to the Redis port (default 6379)</li>
      </ul>
    </section>

    <hr class="section-divider">

    <section class="section" id="configuration">
      <h2>Configuration</h2>
      <p>Config file: <code>~/.omo/configs/redis/redis.yaml</code> (auto-created on first launch).</p>
      <p>This file only controls which environments are enabled and UI settings. All connection details are stored in KeePass.</p>

      <div class="code-header"><span>~/.omo/configs/redis/redis.yaml</span></div>
      <pre><code>environments:
  - name: development
    enabled: true
  - name: production
    enabled: true
  - name: staging
    enabled: true

ui:
  refresh_interval: 5
  max_keys_display: 1000
  enable_slowlog: true
  enable_server_info: true</code></pre>

      <div class="callout callout-info">
        <div class="callout-title">KeePass-first</div>
        <p>All connection details (host, port, username, password) are stored exclusively in KeePass entries under <code>redis/&lt;environment&gt;/&lt;name&gt;</code>. The YAML config only controls which environments are enabled and UI behavior.</p>
      </div>
    </section>

    <hr class="section-divider">

    <section class="section" id="keepass-secrets">
      <h2>KeePass Secret Schema</h2>
      <p>Secret path convention: <code>redis/&lt;environment&gt;/&lt;name&gt;</code></p>
      <p>Example: <code>redis/production/main-cache</code></p>

      <div class="table-wrap">
        <table>
          <thead>
            <tr><th>KeePass Field</th><th>Maps To</th><th>Description</th></tr>
          </thead>
          <tbody>
            <tr><td>Title</td><td>Instance name</td><td>Display name in omo</td></tr>
            <tr><td>URL</td><td>host</td><td>Redis server hostname or IP</td></tr>
            <tr><td>UserName</td><td>username</td><td>Redis ACL username (Redis 6+, optional)</td></tr>
            <tr><td>Password</td><td>password</td><td>Redis AUTH password</td></tr>
            <tr><td>Notes</td><td>—</td><td>Description / notes (not used for connection)</td></tr>
          </tbody>
        </table>
      </div>

      <p>No custom attributes — Redis uses only standard KeePass fields.</p>

      <div class="code-header"><span>Example KeePass structure</span></div>
      <pre><code>omo (root)
  └── redis
       ├── development
       │    └── local       (URL=localhost, Password=...)
       ├── staging
       │    └── cache-01    (URL=staging-redis.example.com, ...)
       └── production
            └── main-cache  (URL=redis.prod.internal, UserName=app, Password=...)</code></pre>
    </section>

    <hr class="section-divider">

    <section class="section" id="keybindings">
      <h2>Keybindings</h2>

      <h3>Redis Actions</h3>
      <div class="table-wrap key-table">
        <table>
          <thead><tr><th>Key</th><th>Action</th></tr></thead>
          <tbody>
            <tr><td><kbd>D</kbd></td><td>Delete key</td></tr>
            <tr><td><kbd>F</kbd></td><td>Flush database</td></tr>
            <tr><td><kbd>N</kbd></td><td>New key</td></tr>
            <tr><td><kbd>E</kbd></td><td>View key content</td></tr>
            <tr><td><kbd>I</kbd></td><td>Server info</td></tr>
            <tr><td><kbd>L</kbd></td><td>Slowlog</td></tr>
            <tr><td><kbd>T</kbd></td><td>Stats</td></tr>
            <tr><td><kbd>C</kbd></td><td>Clients</td></tr>
            <tr><td><kbd>G</kbd></td><td>Config</td></tr>
            <tr><td><kbd>M</kbd></td><td>Memory analysis</td></tr>
            <tr><td><kbd>P</kbd></td><td>Persistence info</td></tr>
            <tr><td><kbd>Y</kbd></td><td>Replication</td></tr>
            <tr><td><kbd>B</kbd></td><td>Pub/Sub</td></tr>
            <tr><td><kbd>A</kbd></td><td>Key analysis</td></tr>
            <tr><td><kbd>W</kbd></td><td>Databases</td></tr>
            <tr><td><kbd>X</kbd></td><td>Command stats</td></tr>
            <tr><td><kbd>Z</kbd></td><td>Latency</td></tr>
            <tr><td><kbd>S</kbd></td><td>Database selector</td></tr>
            <tr><td><kbd>Ctrl+T</kbd></td><td>Instance selector</td></tr>
          </tbody>
        </table>
      </div>

      <h3>Global Navigation</h3>
      <div class="table-wrap key-table">
        <table>
          <thead><tr><th>Key</th><th>Action</th></tr></thead>
          <tbody>
            <tr><td><kbd>j</kbd> / <kbd>k</kbd></td><td>Navigate down / up</td></tr>
            <tr><td><kbd>Enter</kbd></td><td>Select</td></tr>
            <tr><td><kbd>/</kbd></td><td>Filter</td></tr>
            <tr><td><kbd>Shift+Tab</kbd></td><td>Cycle panels</td></tr>
            <tr><td><kbd>R</kbd></td><td>Refresh</td></tr>
            <tr><td><kbd>?</kbd></td><td>Help</td></tr>
            <tr><td><kbd>Esc</kbd></td><td>Back</td></tr>
            <tr><td><kbd>PgDn</kbd></td><td>Load more</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <hr class="section-divider">

    <section class="section" id="views">
      <h2>Views</h2>
      <p>The Redis plugin provides 14 views:</p>
      <ul>
        <li><strong>Keys</strong> (default) — Browse keys by pattern with type, TTL, and size. Filter, delete, create, and inspect key values.</li>
        <li><strong>Info</strong> — Server information, version, uptime, and runtime configuration.</li>
        <li><strong>Slowlog</strong> — Slow command log with execution times and stack traces.</li>
        <li><strong>Stats</strong> — Real-time statistics (connections, commands, keyspace hits/misses).</li>
        <li><strong>Clients</strong> — Connected clients list with addresses and idle times.</li>
        <li><strong>Config</strong> — Server configuration parameters (CONFIG GET).</li>
        <li><strong>Memory</strong> — Memory analysis and usage breakdown.</li>
        <li><strong>Replication</strong> — Replication role, master/slave status, and sync state.</li>
        <li><strong>Persistence</strong> — RDB/AOF persistence configuration and last save info.</li>
        <li><strong>PubSub</strong> — Pub/Sub channels; subscribe and view live messages.</li>
        <li><strong>Key Analysis</strong> — Pattern-based key statistics (count, types, avg TTL, samples).</li>
        <li><strong>Databases</strong> — Overview of all databases and key counts.</li>
        <li><strong>Command Stats</strong> — Per-command call counts and CPU time.</li>
        <li><strong>Latency</strong> — Latency statistics and histogram.</li>
      </ul>
    </section>

    <hr class="section-divider">

    <section class="section" id="troubleshooting">
      <h2>Troubleshooting</h2>
      <ul>
        <li><strong>Connection refused</strong> — Check host and port. Ensure Redis is running and reachable.</li>
        <li><strong>AUTH failed</strong> — Verify password in KeePass. Ensure <code>requirepass</code> matches your entry.</li>
        <li><strong>ACL errors</strong> — Redis 6+ is required for username-based ACL authentication.</li>
      </ul>

      <div class="callout callout-tip">
        <div class="callout-title">Tip</div>
        <p>Use <kbd>Ctrl+T</kbd> to switch between configured Redis instances. Ensure at least one entry exists in KeePass under <code>redis/&lt;environment&gt;/&lt;name&gt;</code>.</p>
      </div>

      <div class="callout callout-warn">
        <div class="callout-title">KeePass</div>
        <p>If using KeePass for secrets, ensure omo has access to the KeePass database and that the secret path matches the entry hierarchy (e.g. <code>redis/development/local</code>).</p>
      </div>
    </section>

    <footer class="footer">
      <p>Built by <a href="https://oh-myops.com">Hatem Ben Tayeb</a> &bull; <a href="https://github.com/hatembentayeb/omo">GitHub</a> &bull; Apache License 2.0</p>
    </footer>

  </div>
</main>

<script>
// Sidebar active state on scroll
const sections = document.querySelectorAll('.section[id], .plugin-hero[id]');
const navLinks = document.querySelectorAll('.sidebar a[href^="#"]');

function updateActiveNav() {
  const scrollPos = window.scrollY + 100;
  let current = '';

  sections.forEach(section => {
    if (section.offsetTop <= scrollPos) {
      current = section.getAttribute('id');
    }
  });

  navLinks.forEach(link => {
    link.classList.remove('active');
    if (link.getAttribute('href') === '#' + current) {
      link.classList.add('active');
    }
  });
}

window.addEventListener('scroll', updateActiveNav);
window.addEventListener('load', updateActiveNav);
</script>

</body>
</html>
